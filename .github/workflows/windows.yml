name: Windows (CMake)

on: [push, workflow_dispatch]

env:
  BUILD_TYPE: Release

jobs:
  build:
    runs-on: windows-2019

    steps:
    - uses: actions/checkout@v2
      with:
        submodules: true

    - name: Install Tools
      shell: cmd
      run: choco install cmake -y --no-progress --version=3.19.2 --installargs 'ADD_CMAKE_TO_PATH=System'
      run: vcpkg install wxwidgets

    - name: Create Build Environment
      shell: cmd
      run: cmake -E make_directory ./build/cmake

    - name: Configure CMake
      shell: cmd
      run: cmake -S . -B ./build/cmake -DCMAKE_BUILD_TYPE=$BUILD_TYPE

    - name: Build
      shell: cmd
      run: cmake --build build/cmake --parallel --config $BUILD_TYPE
